<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>bmrzzz</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    padding: 16px 0 30px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    user-select: none;
    color: #fff;
    font-family: 'Inter', 'Roboto', sans-serif;

    /* ===== –§–û–ù (–í–°–¢–ê–í–¨ –°–Æ–î–ê RAW-–°–°–´–õ–ö–£ –° GITHUB) ===== */
    background:
        linear-gradient(to bottom, rgba(0,0,0,0.75), rgba(0,0,0,0.95)),
        url("https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/background.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

/* ===== –°–¢–ê–¢–ê ===== */
.stats-container {
    width: 90%;
    max-width: 420px;
    margin-top: 12px;
    padding: 18px 22px;
    border-radius: 22px;
    background: rgba(40,0,0,0.55);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,0,0,0.35);
    box-shadow: 0 0 30px rgba(255,0,0,0.4);
}

.stats {
    font-size: 22px;
    font-weight: 800;
    text-shadow: 0 0 10px rgba(255,80,80,0.9);
}

/* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
.nav-tabs {
    display: flex;
    gap: 12px;
    margin: 18px 0 10px;
    flex-wrap: wrap;
    justify-content: center;
}

.tab-btn {
    padding: 10px 26px;
    border-radius: 14px;
    border: 1px solid #ff2a2a;
    background: linear-gradient(145deg, #1a0000, #2a0000);
    color: white;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 0 14px rgba(255,0,0,0.35);
}

.tab-btn.active {
    background: linear-gradient(145deg, #ff0000, #8b0000);
    box-shadow: 0 0 25px rgba(255,0,0,0.9);
}

/* ===== –≠–ö–†–ê–ù–´ ===== */
.screen {
    display: none;
    width: 100%;
    max-width: 480px;
    flex-direction: column;
    align-items: center;
}
.active-screen { display: flex; }

/* ===== –Ø–ô–¶–û ===== */
#coin {
    width: 230px;
    height: 230px;
    border-radius: 50%;
    border: 4px solid rgba(255,50,50,0.9);
    object-fit: cover;
    margin: 20px 0;
    cursor: pointer;
    box-shadow:
        0 0 35px rgba(255,0,0,0.9),
        0 0 70px rgba(255,0,0,0.4);
    transition: transform 0.12s;
}
#coin:active { transform: scale(0.93); }

/* ===== –ö–ù–û–ü–ö–ò ===== */
.grid {
    width: 92%;
    max-width: 420px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-top: 18px;
}

.neon-btn {
    padding: 15px 12px;
    border-radius: 16px;
    border: none;
    font-weight: 800;
    color: white;
    cursor: pointer;
    background: linear-gradient(145deg, #ff1a1a, #7a0000);
    box-shadow:
        0 6px 20px rgba(255,0,0,0.6),
        inset 0 0 12px rgba(255,255,255,0.12);
}
.neon-btn:active { transform: scale(0.96); }

/* ===== –ö–ê–ó–ò–ù–û ===== */
.casino-section {
    width: 92%;
    max-width: 420px;
    margin-top: 26px;
    padding: 18px 14px;
    border-radius: 18px;
    background: rgba(20,0,0,0.6);
    border: 1px solid rgba(255,0,0,0.3);
    box-shadow: 0 0 25px rgba(255,0,0,0.4);
}

.casino-title {
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 14px;
    text-shadow: 0 0 15px rgba(255,0,0,0.9);
}
/* ====== –ë–û–°–°–´ ====== */
.boss-card {
    background: rgba(70, 0, 0, 0.55);
    border-radius: 18px;
    padding: 16px;
    margin: 12px 0;
    width: 92%;
    max-width: 420px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    text-align: left;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
}
.boss-info {
    text-shadow: 0 0 6px rgba(255, 80, 80, 0.6);
}
.boss-info small {
    display: block;
    opacity: 0.85;
    margin-top: 4px;
}
#boss-img {
    width: 230px;       /* —Ç–∞–∫–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä, –∫–∞–∫ —è–π—Ü–æ */
    height: 230px;
    border-radius: 50%;
    border: 4px solid rgba(255,50,50,0.9);
    object-fit: cover;
    margin: 20px 0;
    cursor: pointer;
    box-shadow:
        0 0 35px rgba(255,0,0,0.9),
        0 0 70px rgba(255,0,0,0.4);
    transition: transform 0.12s;
}
#boss-img:active {
    transform: scale(0.93);
}
/* ====== HP ====== */
.hp-container {
    width: 85%;
    height: 26px;
    background: #1c0000;
    border-radius: 14px;
    overflow: hidden;
    margin: 12px 0;
    box-shadow: inset 0 0 8px rgba(255, 0, 0, 0.6);
}

#hp-bar {
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff9a9a);
    box-shadow: 0 0 12px rgba(255, 0, 0, 0.8);
}

/* ===== –°–ï–ü–ê–†–ê–¢–û–† ===== */
.boss-separator {
    width: 70%;
    height: 2px;
    margin: 22px 0;
    background: linear-gradient(
        to right,
        transparent,
        #ff2a2a,
        transparent
    );
    box-shadow: 0 0 12px rgba(255,0,0,0.9);
}
</style>
</head>
<body>

<div class="stats-container">
    <div class="stats">–ù–∞—Ç—ã–∫–∞–ª(–∞) –ø–æ —è–π—Ü–∞–º: <span id="balance">0</span></div>
    <div class="stats">‚ö° –°–∏–ª–∞ –∫–ª–∏–∫–∞: <span id="clickLvl">1</span></div>

    <div class="nav-tabs">
        <button class="tab-btn active" onclick="showScreen('main', this)">–ì–õ–ê–í–ù–ê–Ø</button>
        <button class="tab-btn" onclick="showScreen('boss-list', this)">–ë–û–°–°–´</button>
        <button class="tab-btn" onclick="showScreen('gamble', this)">–ö–ê–ó–ò–ù–û</button>
    </div>
</div>

<!-- –≠–ö–†–ê–ù –ì–õ–ê–í–ù–ê–Ø -->
<div id="main" class="screen active-screen">
    <img id="coin" src="https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/andrey.png" onclick="clickCoin()">
    <div class="grid">
        <button class="neon-btn" onclick="upgradeClick()">
            ‚ûï –°–ò–õ–ê +1<br>
            <small>–¶–µ–Ω–∞: <span id="upgradeCost">10</span></small>
        </button>

        <button class="neon-btn" onclick="upgradeClickX2()">
            üí• –°–ò–õ–ê x2<br>
            <small>–¶–µ–Ω–∞: <span id="x2Cost">50000000</span></small>
        </button>
        <button class="neon-btn" onclick="upgradeMax()">
            üî• –°–∏–ª–∞<br>
            <small>–ö—É–ø–∏—Ç—å —Å–∏–ª—É –Ω–∞ –≤—Å–µ –¥–µ–Ω—å–≥–∏</small>
        </button>        
        <button class="neon-btn" onclick="saveGame()">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
        <button id="musicBtn" class="neon-btn" onclick="toggleMusic()">üéµ –í–∫–ª/–í—ã–∫–ª</button>
    </div>
</div>

<!-- –ê—É–¥–∏–æ (—Å–∫—Ä—ã—Ç–æ) -->
<audio id="bgMusic" loop preload="auto">
    <source src="https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/Music.mp3" type="audio/mpeg">
</audio>

<!-- –≠–ö–†–ê–ù –ê–ó–ê–†–¢ -->
<div id="gamble" class="screen">
    <h2>üé∞ –ö–ê–ó–ò–ù–û</h2>
    <p>–í—ã–±–µ—Ä–∏ —Å–∫–æ–ª—å–∫–æ –¥–µ–ø–Ω—É—Ç—å —Ö–æ—á–µ—à—å</p>

    <!-- –°–¢–ê–í–ö–ò -->
    <div class="grid">
        <button class="neon-btn" onclick="setBetPercent(5)">5%</button>
        <button class="neon-btn" onclick="setBetPercent(10)">10%</button>
        <button class="neon-btn" onclick="setBetPercent(15)">15%</button>
        <button class="neon-btn" onclick="setBetPercent(35)">35%</button>
        <button class="neon-btn" onclick="setBetPercent(50)">50%</button>
        <button class="neon-btn" onclick="setBetPercent(75)">75%</button>
        <button class="neon-btn" onclick="setAllIn()">ALL IN</button>
    </div>

    <p style="margin-top:15px;">
        –°—Ç–∞–≤–∫–∞: <b><span id="currentBet">0</span></b>
    </p>

    <!-- ===== –£–ì–ê–î–ê–ô –¶–í–ï–¢ ===== -->
    <div class="casino-section">
        <div class="casino-title">üé® –£–ì–ê–î–ê–ô –¶–í–ï–¢</div>
        <div class="grid">
            <button class="neon-btn" style="background:#ff0000" onclick="playGamble('red')">üî¥</button>
            <button class="neon-btn" style="background:#00aa00" onclick="playGamble('green')">üü¢</button>
            <button class="neon-btn" style="background:#0000ff" onclick="playGamble('blue')">üîµ</button>
        </div>
    </div>

    <!-- ===== –û–î–ù–û–†–£–ö–ò–ô –ë–ê–ù–î–ò–¢ ===== -->
    <div class="casino-section">
        <div class="casino-title">üé∞ –û–î–ù–û–†–£–ö–ò–ô –ë–ê–ù–î–ò–¢</div>
        <button class="neon-btn" onclick="playSlots()">–ö–†–£–¢–ò–¢–¨</button>
        <p id="slotResult"></p>
    </div>

    <!-- ===== 21 ===== -->
    <div class="casino-section">
        <div class="casino-title">üÉè 21</div>
        <button class="neon-btn" onclick="startBlackjack()">–í–ó–Ø–¢–¨ –ö–ê–†–¢–´</button>
        <button class="neon-btn" onclick="blackjackStand()">–°–¢–û–ü</button>
        <p id="blackjackInfo"></p>
    </div>

    <p id="gambleResult" style="margin-top:15px;"></p>
</div>

<div id="boss-list" class="screen">

    <div class="boss-card">
        <div class="boss-info">
            <b>–•–æ–¥–∏–ª–∫–∞ –±—Ä–æ–¥–∏–ª–∫–∞</b>
            <small>HP: 3 000</small>
            <small>–í—Ö–æ–¥: 1 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 15 000</small>
            <small>–ü–æ—è–≤–ª—è–µ—Ç—Å—è –≤–Ω–µ–∑–∞–ø–Ω–æ. –£—Ö–æ–¥–∏—Ç –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–•–æ–¥–∏–ª–∫–∞ –±—Ä–æ–¥–∏–ª–∫–∞',3000,15000,1000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/hodilkabrodilka.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ú–µ—Ä—Å–µ–¥–µ—Å</b>
            <small>HP: 800</small>
            <small>–í—Ö–æ–¥: 3 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 15 000</small>
            <small>–£—á–∏—Ç–µ–ª—å-–∫–∞—Ä–∞—Ç–µ–ª—å. –ó–≤–æ–Ω–æ–∫ –¥–ª—è –Ω–µ—ë ‚Äî –Ω–µ –∑–∞–∫–æ–Ω.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ú–µ—Ä—Å–µ–¥–µ—Å',800,15000,3000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/mersedes.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–§–∏–∑–∏–∫</b>
            <small>HP: 1 500</small>
            <small>–í—Ö–æ–¥: 8 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 30 000</small>
            <small>–ó–∞—Å—Ç–∞–≤–∏—Ç —Å—Ç—Ä–∞–¥–∞—Ç—å –¥–∞–∂–µ –æ—Ç–ª–∏—á–Ω–∏–∫–æ–≤.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–§–∏–∑–∏–∫',1500,30000,8000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/fizik.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ê–≥–∞–∞–∞–∞–∞–∞</b>
            <small>HP: 2 500</small>
            <small>–í—Ö–æ–¥: 5 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 30 000</small>
            <small>–û—Ä —Å–ª—ã—à–µ–Ω –∑–∞ —Ç—Ä–∏ —Ä–∞–π–æ–Ω–∞.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ê–≥–∞–∞–∞–∞–∞–∞',2500,30000,5000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/agaaa.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ò–∏—Å—Ç–æ–æ–æ–æ—Ä–∏–∏–∏–∫</b>
            <small>HP: 12 000</small>
            <small>–í—Ö–æ–¥: 30 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 250 000</small>
            <small>–§–∞ –§–∞ –§–∞ —à–Ω–µ–π–Ω–µ –≤–∞—Ç–∞—Ñ–∞.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ò–∏—Å—Ç–æ–æ–æ–æ—Ä–∏–∏–∏–∫',12000,250000,30000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/istorik.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ñ–∞–Ω–Ω–∞ –ö–∏—Å–∫–∞</b>
            <small>HP: 25 000</small>
            <small>–í—Ö–æ–¥: 60 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 500 000</small>
            <small>–ú–æ—Ä–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω x10.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ñ–∞–Ω–Ω–∞ –ö–∏—Å–∫–∞',25000,500000,60000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/jannakiska.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ú–æ—Ö-–ò—Ä–µ–≤–∞</b>
            <small>HP: 40 000</small>
            <small>–í—Ö–æ–¥: 120 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 1 000 000</small>
            <small>–ë—å—ë—Ç —Å–ª–æ–≤–æ–º —Å–∏–ª—å–Ω–µ–µ –∫—É–ª–∞–∫–∞.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ú–æ—Ö-–ò—Ä–µ–≤–∞',40000,1000000,120000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/moxireva.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–î–∏–∫–∞—è —Ç—Ä–æ–∏—Ü–∞</b>
            <small>HP: 80 000</small>
            <small>–í—Ö–æ–¥: 250 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 750 000</small>
            <small>–ë—å—é—Ç –≤—Ç—Ä–æ—ë–º. –î—É–º–∞—é—Ç –Ω–æ–ª—å —Å–µ–∫—É–Ω–¥.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–î–∏–∫–∞—è —Ç—Ä–æ–∏—Ü–∞',80000,750000,250000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/troica.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ú–∏—à—É–∫</b>
            <small>HP: 120 000</small>
            <small>–í—Ö–æ–¥: 500 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 2 000 000</small>
            <small>–ü–æ–º–Ω–∏—Ç –æ—Ü–µ–Ω–∫–∏. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–±—ã–≤–∞–µ—Ç.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ú–∏—à—É–∫',120000,2000000,500000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/mishyk.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–®–ï–í–ê</b>
            <small>HP: 150 000</small>
            <small>–í—Ö–æ–¥: 500 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 2 000 000</small>
            <small>–î–æ —Å–≤–∏–¥–∞–Ω–∏—è, –¥–æ–ª–±–∞–µ–±.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–®–ï–í–ê',150000,2000000,500000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/sheva.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ê—Ä—Ç–µ–º–∏–π</b>
            <small>HP: 300 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 10 000 000</small>
            <small>–ö—Ä—É—Ç–æ–π –ø–∞—Ü–∞–Ω</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ê—Ä—Ç–µ–º–∏–π',300000,10000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/tema.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ò–≥–æ—Ä—é–Ω—è</b>
            <small>HP: 750 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 10 000 000</small>
            <small>–ö—Ä—É—Ç–æ–π –ø–∞—Ü–∞–Ω</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ò–≥–æ—Ä—é–Ω—è',750000,10000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/igor.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–î–ï–ú–ï–ù–¢–ò–ô</b>
            <small>HP: 300 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 10 000 000</small>
            <small>–õ—é–±–ª—é —Ç–µ–±—è –ø—É–ø—Å–∏–∫</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–î–ï–ú–ï–ù–¢–ò–ô',300000,10000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/demaa.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ë–ò–ì–ë–û–ù</b>
            <small>HP: 300 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 10 000 000</small>
            <small>–ù–ï –í –ü–†–ê–ô–ú–ï –û–ù</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ë–ò–ì–ë–û–ù',300000,10000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/bigbon.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ë–ò–ì–ë–û–û–û–û–ù –í –ü–†–ê–ô–ú–ï</b>
            <small>HP: 2 000 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 50 000 000</small>
            <small>–û–ù –í –ü–†–ê–ô–ú–ï –ò –ö–£–®–ê–ï–¢ –ü–ï–ß–ï–ù–¨–ï.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ë–ò–ì–ë–û–û–û–û–ù –í –ü–†–ê–ô–ú–ï',2000000,50000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/bigbontwo.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ë–ò–ì–ë–û–ù –ù–ê –°–í–ò–î–ê–ù–ò–ï –£–î–£–ú–ê–õ</b>
            <small>HP: 1 000 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 50 000 000</small>
            <small>–û–ù –í –ü–†–ê–ô–ú–ï –ò –ö–£–®–ê–ï–¢ –ü–ï–ß–ï–ù–¨–ï.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ë–ò–ì–ë–û–ù –ù–ê –°–í–ò–î–ê–ù–ò–ï –£–î–£–ú–ê–õ',1000000,50000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/bigbob.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ü–†–ò–ù–¶–ï–°–°–ê</b>
            <small>HP: 3 000 000</small>
            <small>–í—Ö–æ–¥: 100 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 50 000 000</small>
            <small>–ì–û–¢–û–í–ò–¢ –ë–ê–õ–ê–ù–î–£.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ü–†–ò–ù–¶–ï–°–°–ê',3000000,50000000,100000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/princessa.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ß–û–ü–û–†</b>
            <small>HP: 300 000 000</small>
            <small>–í—Ö–æ–¥: 50 000 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 9 000 000 000</small>
            <small>–ú–Ø–Ø–Ø–Ø–Ø–ß –°–Æ–î–ê–ê–ê–ê–ê–ê.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ß–û–ü–û–†',300000000,9000000000,50000000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/chopor.jpg'
        )">–í –ë–û–ô</button>
    </div>
    <div class="boss-separator"></div>
    <div class="boss-card">
        <div class="boss-info">
            <b>–ß–û–ü–û–† –í –ü–†–ê–ô–ú–ï</b>
            <small>HP: 3 000 000 000 000</small>
            <small>–í—Ö–æ–¥: 50 000 000</small>
            <small>–ù–∞–≥—Ä–∞–¥–∞: 999 999 999 999</small>
            <small>–ú–Ø–Ø–Ø–Ø–Ø–ß –°–Æ–î–ê–ê–ê–ê–ê–ê.</small>
        </div>
        <button class="neon-btn" onclick="startBossFight(
            '–ß–û–ü–û–† –í –ü–†–ê–ô–ú–ï',3000000000000,999999999999,50000000,
            'https://raw.githubusercontent.com/bmrzzmrb/TapikTap/main/chopor.jpg'
        )">–í –ë–û–ô</button>
    </div>

</div>

<!-- –≠–ö–†–ê–ù –ë–û–Ø -->
<div id="boss-battle" class="screen">
    <h2 id="boss-name">–ë–û–°–°</h2>
    <div id="timer">‚è±Ô∏è 60</div>
    <div class="hp-container"><div id="hp-bar"></div></div>
    <img id="boss-img" onclick="hitBoss()">
</div>

<script>
let tg = window.Telegram.WebApp;
tg.expand();

// ===== –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ =====
let balance = 0;
let clickPower = 1;
let upgradeCost = 10;
let saveTimeout = null;
let upgradePriceStep = 10;
let x2UpgradeCost = 50000000;

// ===== –ê–ù–¢–ò-–ê–í–¢–û–ö–õ–ò–ö–ï–† =====
let clickTimestamps = [];
let clickBlockedUntil = 0;

const MAX_CLICKS_PER_SEC = 15;
const BLOCK_TIME_MS = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç

// ===== –ë–û–°–° =====
let bossHp = 0;
let bossMaxHp = 0;
let bossReward = 0;
let fightTimer = null;
let timeLeft = 0;
let inBossFight = false;

function formatNumber(num) {
    return Math.floor(num).toLocaleString('de-DE');
}

// ===== –í–ò–ë–†–ê–¶–ò–Ø =====
function vibrate(type = 'light') {
    if (tg.HapticFeedback) {
        tg.HapticFeedback.impactOccurred(type);
    }
}

// ===== –ê–ó–ê–†–¢ =====
let currentBet = 0;

function setBet(amount) {
    currentBet = Math.min(amount, balance);
    updateGambleUI();
}

function setBetPercent(percent) {
    currentBet = Math.floor(balance * (percent / 100));
    updateGambleUI();
}

function setAllIn() {
    currentBet = balance;
    updateGambleUI();
}

function updateGambleUI() {
    document.getElementById('currentBet').innerText = formatNumber(currentBet);
}

function playGamble(color) {
    if (currentBet <= 0) {
        tg.showAlert('–°—Ç–∞–≤–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞');
        return;
    }

    if (currentBet > balance) {
        tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —è–∏—Ü');
        return;
    }

    const colors = ['red', 'green', 'blue'];
    const result = colors[Math.floor(Math.random() * colors.length)];

    balance -= currentBet;

    let text = '–í—ã–ø–∞–ª —Ü–≤–µ—Ç: ';

    if (result === 'red') text += 'üî¥';
    if (result === 'green') text += 'üü¢';
    if (result === 'blue') text += 'üîµ';

    if (result === color) {
        const win = currentBet * 2;
        balance += win;
        text += '<br><b>üéâ –ü–æ–±–µ–¥–∞! +' + formatNumber(win) + '</b>';
    } else {
        text += '<br><b>‚ùå –ü—Ä–æ–∏–≥—Ä—ã—à</b>';
    }

    currentBet = 0;
    document.getElementById('gambleResult').innerHTML = text;

    updateUI();
    updateGambleUI();
    saveGame();
}

function playSlots() {
    if (currentBet <= 0 || currentBet > balance) {
        tg.showAlert('–°—Ç–∞–≤–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞');
        return;
    }

    balance -= currentBet;

    const symbols = ['üçí', 'üçã', 'üîî', 'üíé'];
    const a = symbols[Math.floor(Math.random()*symbols.length)];
    const b = symbols[Math.floor(Math.random()*symbols.length)];
    const c = symbols[Math.floor(Math.random()*symbols.length)];

    let text = a + ' | ' + b + ' | ' + c;

    if (a === b && b === c) {
        const win = currentBet * 5;
        balance += win;
        text += `<br><b>üéâ –î–ñ–ï–ö–ü–û–¢ +${formatNumber(win)}</b>`;
    } else if (a === b || b === c || a === c) {
        const win = currentBet * 2;
        balance += win;
        text += `<br><b>‚úÖ –í—ã–∏–≥—Ä—ã—à +${formatNumber(win)}</b>`;
    } else {
        text += `<br><b>‚ùå –ü—Ä–æ–∏–≥—Ä—ã—à</b>`;
    }

    document.getElementById('slotResult').innerHTML = text;
    currentBet = 0;
    updateUI();
    updateGambleUI();
    saveGame();
}

let playerScore = 0;
let dealerScore = 0;
let blackjackActive = false;

function drawCard() {
    return Math.floor(Math.random() * 10) + 2;
}

function startBlackjack() {
    if (currentBet <= 0 || currentBet > balance) {
        tg.showAlert('–°—Ç–∞–≤–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞');
        return;
    }

    balance -= currentBet;
    playerScore = drawCard() + drawCard();
    dealerScore = drawCard();
    blackjackActive = true;

    updateBlackjackInfo();
}

function blackjackStand() {
    if (!blackjackActive) return;

    dealerScore += drawCard();

    let text = '';
    if (playerScore > 21) {
        text = '‚ùå –ü–µ—Ä–µ–±–æ—Ä';
    } else if (dealerScore > 21 || playerScore > dealerScore) {
        const win = currentBet * 2;
        balance += win;
        text = 'üéâ –ü–æ–±–µ–¥–∞ +' + formatNumber(win);
    } else {
        text = '‚ùå –ü—Ä–æ–∏–≥—Ä—ã—à';
    }

    blackjackActive = false;
    currentBet = 0;
    document.getElementById('blackjackInfo').innerHTML += `<br><b>${text}</b>`;
    updateUI();
    updateGambleUI();
    saveGame();
}

function updateBlackjackInfo() {
    document.getElementById('blackjackInfo').innerHTML =
        `–¢—ã: ${playerScore}<br>–î–∏–ª–µ—Ä: ${dealerScore}`;
}

function isClickBlocked() {
    const now = Date.now();

    if (now < clickBlockedUntil) {
        const secondsLeft = Math.ceil((clickBlockedUntil - now) / 1000);
        tg.showAlert('‚õî –ü–ò–î–û–†–ê–° –û–ë–ù–ê–†–£–ñ–ï–ù\n–°–æ—Å–∏ —Ö—É–π ' + secondsLeft + ' —Å–µ–∫.');
        return true;
    }

    return false;
}

function upgradeMax() {
    let bought = 0;

    while (balance >= upgradeCost) {
        balance -= upgradeCost;
        clickPower += 1;
        upgradeCost += upgradePriceStep;
        bought++;
    }

    if (bought > 0) {
        vibrate('heavy');
        tg.showAlert('üî• –ö—É–ø–ª–µ–Ω–æ —É—Ä–æ–≤–Ω–µ–π: ' + bought);
        updateUI();
        saveGame();
    } else {
        tg.showAlert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —è–∏—Ü');
    }
}

// –£–º–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–õ–æ–∫–∞–ª—å–Ω–æ + –û–±–ª–∞–∫–æ)
function saveGame() {
    const data = {
        balance: balance,
        clickPower: clickPower,
        upgradeCost: upgradeCost,
        x2UpgradeCost: x2UpgradeCost,
        clickBlockedUntil: clickBlockedUntil,
        lastSave: Date.now()
    };

    // 1. –°—Ä–∞–∑—É –≤ LocalStorage (–¥–ª—è –ü–ö)
    localStorage.setItem('eggGameSave', JSON.stringify(data));

    // 2. –í –û–±–ª–∞–∫–æ –¢–ì —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (—á—Ç–æ–±—ã –Ω–µ –∑–∞–±–∞–Ω–∏–ª–∏ –∑–∞ —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
    if (tg.isVersionAtLeast('6.9')) {
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(() => {
            tg.CloudStorage.setItem('gameData', JSON.stringify(data), (err) => {
                if (err) console.error("Cloud save error", err);
            });
        }, 1000); 
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞
function loadGame() {
    // –°–Ω–∞—á–∞–ª–∞ –∏–∑ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
    const local = localStorage.getItem('eggGameSave');
    if (local) {
        const d = JSON.parse(local);
        balance = d.balance || 0;
        clickPower = d.clickPower || 1;
        upgradeCost = d.upgradeCost || 10;
        x2UpgradeCost = d.x2UpgradeCost || 50000000;
        clickBlockedUntil = d.clickBlockedUntil || 0;
        updateUI();
    }

    // –ü–æ—Ç–æ–º –∏–∑ –æ–±–ª–∞–∫–∞ –¢–ì (–µ—Å–ª–∏ —Ç–∞–º –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–µ–µ)
    if (tg.isVersionAtLeast('6.9')) {
        tg.CloudStorage.getItem('gameData', (err, value) => {
            if (!err && value) {
                const cloud = JSON.parse(value);
                const localData = local ? JSON.parse(local) : { lastSave: 0 };
                
                if (cloud.lastSave > localData.lastSave) {
                    balance = cloud.balance;
                    clickPower = cloud.clickPower;
                    upgradeCost = cloud.upgradeCost;
                    x2UpgradeCost = cloud.x2UpgradeCost;
                    clickBlockedUntil = d.clickBlockedUntil;
                    updateUI();
                }
            }
        });
    }
}

function updateUI() {
    document.getElementById('balance').innerText = formatNumber(balance);
    document.getElementById('clickLvl').innerText = formatNumber(clickPower);
    document.getElementById('upgradeCost').innerText = formatNumber(upgradeCost);

    if (document.getElementById('x2Cost')) {
        document.getElementById('x2Cost').innerText = formatNumber(x2UpgradeCost);
    }
}

let musicOn = false;
const bgMusic = document.getElementById('bgMusic');
const musicBtn = document.getElementById('musicBtn');

// –≤–∞–∂–Ω–æ
bgMusic.volume = 0.5;
bgMusic.muted = true; // —Å—Ç–∞—Ä—Ç—É–µ–º –∑–∞–≥–ª—É—à—ë–Ω–Ω—ã–º

function toggleMusic() {
    if (!musicOn) {
        bgMusic.muted = false;

        const playPromise = bgMusic.play();
        if (playPromise !== undefined) {
            playPromise
                .then(() => {
                    musicOn = true;
                    musicBtn.innerText = 'üîä –ú—É–∑—ã–∫–∞ –í–ö–õ';
                    musicBtn.style.background = 'linear-gradient(135deg, #00ff00, #007700)';
                    musicBtn.style.boxShadow = '0 0 25px #00ff00';
                })
                .catch(err => {
                    console.log('Play error:', err);
                    tg.showAlert('‚ùå –ù–∞–∂–º–∏ –µ—â—ë —Ä–∞–∑ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º—É–∑—ã–∫–∏');
                });
        }
    } else {
        bgMusic.pause();
        musicOn = false;
        musicBtn.innerText = 'üéµ –ú—É–∑—ã–∫–∞ –í–´–ö–õ';
        musicBtn.style.background = 'linear-gradient(135deg, #ff0000, #7a0000)';
        musicBtn.style.boxShadow = '0 0 25px rgba(255,0,0,0.9)';
    }
}

function clickCoin() {
    const now = Date.now();

    // ‚õî –ï—Å–ª–∏ –∫–ª–∏–∫–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
    if (isClickBlocked()) return;

    clickTimestamps = clickTimestamps.filter(t => now - t < 1000);
    clickTimestamps.push(now);

    // üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞
    if (clickTimestamps.length > MAX_CLICKS_PER_SEC) {
        clickBlockedUntil = now + BLOCK_TIME_MS;
        clickTimestamps = [];

        tg.showAlert('üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–∏–¥–æ—Ä–∞—Å —Å –∫–ª–∏–∫–µ—Ä–æ–º!\n–ö–ª–∏–∫–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ 5 –º–∏–Ω—É—Ç.');
        saveGame();
        return;
    }

    // ‚úÖ –û–±—ã—á–Ω—ã–π –∫–ª–∏–∫
    balance += clickPower;
    vibrate('light');
    updateUI();
    saveGame();

    const img = document.getElementById('coin');
    img.style.transform = 'scale(0.95)';
    setTimeout(() => img.style.transform = 'scale(1)', 50);
}

function upgradeClick() {
    if (balance >= upgradeCost) {
        balance -= upgradeCost;
        clickPower += 1; 
        upgradeCost = upgradeCost + upgradePriceStep;
        vibrate('medium');
        updateUI();
        saveGame();
    } else {
        tg.showAlert('–ú–∞–ª–æ —è–∏—Ü!');
    }
}
function upgradeClickX2() {
    if (balance >= x2UpgradeCost) {
        balance -= x2UpgradeCost;
        clickPower *= 2;
        x2UpgradeCost *= 5;
        vibrate('heavy');
        updateUI();
        saveGame();
    } else {
        tg.showAlert('–ù—É–∂–Ω–æ ' + x2UpgradeCost + ' —è–∏—Ü!');
    }
}
// ===== –°–¢–ê–†–¢ –ë–û–°–°–ê =====
function startBossFight(name, hp, reward, cost, img) {
    if (balance < cost) {
        tg.showAlert('–ù—É–∂–Ω–æ ' + cost + ' —è–∏—Ü!');
        return;
    }

    balance -= cost;
    updateUI();

    bossHp = hp;
    bossMaxHp = hp;
    bossReward = reward;
    timeLeft = 60;
    inBossFight = true;

    document.getElementById('boss-name').innerText = name;
    document.getElementById('boss-img').src = img;
    document.getElementById('hp-bar').style.width = '100%';
    document.getElementById('timer').innerText = '‚è±Ô∏è 60';

    showScreen('boss-battle');

    clearInterval(fightTimer);
    fightTimer = setInterval(() => {
        timeLeft--;
        document.getElementById('timer').innerText = '‚è±Ô∏è ' + timeLeft;

        if (timeLeft <= 0) {
            endBossFight(false, '‚è±Ô∏è –í—Ä–µ–º—è –≤—ã—à–ª–æ! –¢—ã –¥–æ–ª–±–∞–µ–±');
        }
    }, 1000);
}

// ===== –£–î–ê–† –ü–û –ë–û–°–°–£ =====
function hitBoss() {
    if (!inBossFight) return;

    // –£–†–û–ù
    bossHp -= clickPower;
    if (bossHp < 0) bossHp = 0;

    // üîÆ 5% –õ–ï–ß–ï–ù–ò–ï
    if (Math.random() < 0.05 && bossHp > 0) {
        const heal = Math.floor(bossMaxHp * 0.1);
        bossHp = Math.min(bossHp + heal, bossMaxHp);
        tg.showAlert('–ë–æ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª HP! –û–ù –Æ–ó–ê–ï–¢ –ó–ê–ù–´');
    }

    // üí∞ 15% –ö–†–ê–ñ–ê
    if (Math.random() < 0.0002 && balance > 0) {
        const stolen = Math.max(1, Math.floor(balance * 0.05));
        balance = Math.max(0, balance - stolen);
        tg.showAlert('–ë–æ—Å—Å —Å–ø–∏–∑–¥–∏–ª ' + stolen + ' —è–∏—Ü!');
        updateUI();
    }

    vibrate('light');

    document.getElementById('hp-bar').style.width =
        (bossHp / bossMaxHp * 100) + '%';

    if (bossHp <= 0) {
        endBossFight(true, '–ü–æ–±–µ–¥–∞! +' + bossReward);
    }
}

// ===== –ö–û–ù–ï–¶ –ë–û–Ø =====
function endBossFight(win, message) {
    clearInterval(fightTimer);
    inBossFight = false;

    if (win) {
        balance += bossReward;
        saveGame();
    }

    tg.showAlert(message);
    showScreen('main');
    updateUI();
}

// ===== –≠–ö–†–ê–ù–´ =====
function showScreen(id, btn) {
    document.querySelectorAll('.screen').forEach(s =>
        s.classList.remove('active-screen')
    );
    document.getElementById(id).classList.add('active-screen');

    if (btn) {
        document.querySelectorAll('.tab-btn').forEach(b =>
            b.classList.remove('active')
        );
        btn.classList.add('active');
    }
}

// –°—Ç–∞—Ä—Ç
loadGame();
</script>
</body>
</html>
